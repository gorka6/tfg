import{b as F,r as c,j as s,H as y,L as C}from"./app-BHM8Qecn.js";import{D as M,f as S}from"./filtraOpciones-e9qbK5sA.js";import{A as T}from"./AuthenticatedLayout-CW0lPtAV.js";import{F as R}from"./FondoSeamless-BS9SX-II.js";import"./Footer-Ds5pLnZk.js";import"./transition-BTkwy5qH.js";function $({ficha:n,bonus:h,savThrow1:u,savThrow2:o}){const{t:e}=F(),[t,l]=c.useState(null),[i,j]=c.useState("str"),[d,m]=c.useState(""),a=["str","dex","con","int","wis","cha"],[x,b]=c.useState(0),p=()=>{if(!n||!d)return alert(e.throws.select_dc);const r=Math.floor(Math.random()*20)+1,v=Math.floor((n[i]-10)/2),N=u===i?1:0,w=o===i?1:0,f=h&&h.find(D=>D.attribute.abbrev===i)?.bonus||0,g=v+f+N+w,_=r+g,A=_>=Number(d);l({d20:r,baseMod:v,bonusAtributo:f,classSavThrow1:N,classSavThrow2:w,mod:g,total:_,exito:A}),b(Date.now())};return console.log(a.map(r=>e.create.a)),console.log(e.create.str),c.useEffect(()=>{l(null)},[d,i]),s.jsxs("div",{className:"d20-wrapper",children:[s.jsx("p",{className:"d20-instruction",children:e.throws.difficult_att}),s.jsxs("div",{className:"d20-form-row",children:[s.jsx("input",{className:"d20-input",type:"number",value:d,onChange:r=>m(r.target.value),placeholder:"DC","aria-label":"DC"}),s.jsx("select",{className:"d20-select",value:i,onChange:r=>j(r.target.value),"aria-label":"Atributo",children:a.map(r=>s.jsx("option",{value:r,children:e.create[r]},r))}),s.jsx("button",{className:"d20-button",type:"button",onClick:p,children:e.throws.throw})]}),s.jsxs("div",{className:"d20-media-results",children:[s.jsx("div",{className:"d20-media",children:t?s.jsx(M,{dieType:"d20",rolls:[t.d20],refreshKey:x}):s.jsx("img",{className:"d20-image",src:"/images/dice/d20_box.png",alt:"Dado sin tirar"})}),s.jsx("div",{className:"d20-results",children:t?s.jsxs(s.Fragment,{children:[s.jsx("p",{className:"d20-result-line result-title",children:e.throws.results}),s.jsxs("p",{className:"d20-result-line",children:["d20: ",s.jsx("strong",{children:t.d20})]}),s.jsxs("p",{className:"d20-result-line",children:[e.throws.base_mod," (",e.create[i],"):",s.jsx("strong",{children:t.baseMod>0?`+${t.baseMod}`:t.baseMod})]}),s.jsxs("p",{className:"d20-result-line",children:[e.throws.race_bonus,":",s.jsx("strong",{children:t.bonusAtributo>0?`+${t.bonusAtributo}`:t.bonusAtributo})]}),s.jsxs("p",{className:"d20-result-line",children:[e.throws.sav_throw1," (",e.create[u],"):",s.jsxs("strong",{children:["+",t.classSavThrow1]})]}),s.jsxs("p",{className:"d20-result-line",children:[e.throws.sav_throw2," (",e.create[o],"):",s.jsxs("strong",{children:["+",t.classSavThrow2]})]}),s.jsxs("p",{className:"d20-result-line",children:[e.throws.total_mod,":",s.jsx("strong",{children:t.mod>0?`+${t.mod}`:t.mod})]}),s.jsxs("p",{className:"d20-result-line",children:[e.throws.total," (d20 + ",e.throws.mod,"):",s.jsx("strong",{children:t.total})]}),s.jsx("p",{className:`d20-result-pass ${t.exito?"pass":"fail"}`,children:t.exito?e.throws.pass:e.throws.fail})]}):s.jsx("p",{className:"d20-result-placeholder",children:e.throws.placeholder})})]})]})}function z({fichas:n,bonus:h,characterClasses:u}){const{t:o}=F(),[e,t]=c.useState(""),[l,i]=c.useState(null),j=a=>{const x=a.target.value;t(x);const b=n.find(p=>p.id==x);i(b||null)},d=l?S(h,"race_id",l.race_id).filter(a=>a.subrace_id===null||l.subrace_id&&Number(a.subrace_id)===Number(l.subrace_id)):[],m=l?S(u,"id",l.class_id):[];return s.jsxs(T,{children:[s.jsx(y,{title:"Tiradas"}),s.jsx("div",{className:"tiradas-container",children:s.jsx(R,{children:s.jsxs("div",{className:"tiradas-inner",children:[s.jsx("h2",{className:"tiradas-title",children:o.throws.throws}),n.length===0?s.jsxs("div",{className:"tiradas-empty",children:[s.jsx("p",{children:o.index.nosheets}),s.jsx(C,{href:route("fichas.create"),children:o.index.firstsheet})]}):s.jsxs("div",{className:"tiradas-content",children:[s.jsxs("div",{className:"tiradas-select-group",children:[s.jsx("label",{className:"tiradas-select-text",htmlFor:"fichas",children:o.throws.select}),s.jsxs("select",{id:"fichas",value:e,onChange:j,children:[s.jsx("option",{value:"",children:o.choose_one}),n.map(a=>s.jsx("option",{value:a.id,children:a.name},a.id))]})]}),s.jsx("div",{className:"tiradas-atributos",children:s.jsx($,{ficha:l,bonus:d,savThrow1:m[0]?.saving_throw_attribute1.abbrev,savThrow2:m[0]?.saving_throw_attribute2.abbrev})})]})]})})})]})}export{z as default};
