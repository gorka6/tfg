import{b as k,j as e,r as _}from"./app-BHM8Qecn.js";import{D as L,f as p}from"./filtraOpciones-e9qbK5sA.js";import{P as q}from"./PrimaryButton-DPATzjGR.js";import{n as z}from"./normTexto-DR_SwMev.js";function O({options:o,selected:t,onChange:d,max:g=4}){const m=c=>{const i=t.includes(c)?t.filter(u=>u!==c):t.length<g?[...t,c]:t;d(i)},{t:h}=k();return e.jsx("div",{className:"selector",children:o.map(({value:c,label:i})=>e.jsxs("label",{children:[e.jsx("input",{type:"checkbox",value:c,checked:t.includes(c),onChange:()=>m(c)}),i]},c))})}function j({label:o,value:t,setValue:d}){const{t:g}=k(),[m,h]=_.useState([]),[c,i]=_.useState(!1),[u,x]=_.useState(0),s=()=>{if(c)return;i(!0);const l=Array.from({length:3},()=>Math.floor(Math.random()*6)+1);h(l),x(Date.now());const r=l.reduce((C,E)=>C+E,0);setTimeout(()=>{d(r),i(!1)},800)};return e.jsxs("div",{className:"d6-button",children:[o&&e.jsx("div",{className:"d6-label",children:o}),e.jsx("button",{type:"button",className:"d6-roll-btn",onClick:s,disabled:c,children:c?g.create.rolling:g.create.roll}),e.jsx(L,{dieType:"d6",rolls:m,refreshKey:u}),e.jsx("div",{className:"d6-total",children:c?"â€”":`Total: ${t}`})]})}function b(o,t){return o.map(d=>{const g=z(d.name),m=t[g];return{value:d.id,label:m}})}function w({options:o=[],value:t,onChange:d,label:g,mode:m,disabled:h=!1,placeholder:c}){const[i,u]=_.useState(!1),x=o.find(l=>l.value===t),{t:s}=k();return e.jsxs("div",{className:"grid-select",children:[e.jsx("button",{type:"button",className:"grid-select-trigger",onClick:()=>!h&&u(!i),disabled:h,children:x?x.label:c}),i&&e.jsxs("div",{className:"grid-select-menu",children:[m==="subraces"&&e.jsx("div",{className:"grid-select-item",onClick:()=>{d(null),u(!1)},children:e.jsx("span",{children:s.subraces.no_subrace})}),o.map(l=>e.jsxs("div",{className:"grid-select-item",onClick:()=>{d(l.value),u(!1)},children:[e.jsx("img",{src:`/images/web/form/${m}/${l.value}.png`,alt:l.label}),e.jsx("span",{children:l.label})]},l.value))]})]})}function W({mode:o="create",form:t,races:d=[],subraces:g=[],classes:m=[],backgrounds:h=[],classesSkills:c=[],traits:i=[],languages:u=[],onSubmit:x}){const{t:s}=k(),{data:l,setData:r,reset:C,post:E,processing:F,errors:n}=t,f=l.race_id,V=l.subrace_id,v=l.class_id,B=[{value:"lg",label:s.alignments.lg,color:"#4CAF50"},{value:"ng",label:s.alignments.ng,color:"#8BC34A"},{value:"cg",label:s.alignments.cg,color:"#CDDC39"},{value:"ln",label:s.alignments.ln,color:"#03A9F4"},{value:"tn",label:s.alignments.tn,color:"#9E9E9E"},{value:"cn",label:s.alignments.cn,color:"#FFC107"},{value:"le",label:s.alignments.le,color:"#F44336"},{value:"ne",label:s.alignments.ne,color:"#E91E63"},{value:"ce",label:s.alignments.ce,color:"#9C27B0"}],I=b(d,s.races),A=b(m,s.classes),T=b(h,s.backgrounds),y=b(p(g,"race_id",f),s.subraces),S=b(p(u,"race_id",f).map(a=>({id:a.language.id,name:a.language.name})),s.languages),$=p(c,"class_id",v),D=b($.map(a=>({id:a.skill_id,name:a.skill.name})),s.skills),R=b([...p(i,"race_id",f),...p(i,"subrace_id",V),...p(i,"class_id",v)],s.traits),K=a=>{a.preventDefault(),x?x():E(route("fichas.store"),{onSuccess:()=>C()})},M=a=>{const N=a===""?null:Number(a);r("race_id",N),r("subrace_id",null),r("traits",[])},P=a=>{const N=a===""?null:Number(a);r("subrace_id",N),r("traits",[])},G=a=>{const N=a===""?null:Number(a);r("class_id",N),r("skills",[]),r("traits",[])};return e.jsx("div",{className:"ficha-form-wrapper",children:e.jsxs("form",{onSubmit:K,className:"ficha-form",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"name",className:"form-label",children:s.create.name}),e.jsx("input",{id:"name",type:"text",value:l.name,placeholder:s.create.enter_name,onChange:a=>r("name",a.target.value)}),n.name&&e.jsx("p",{className:"error-msg",children:n.name})]}),e.jsx("div",{className:"sword-container",children:e.jsx("img",{className:"sword",src:"/images/web/form/sword.png",alt:"Espada decorativa"})}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"race",className:"form-label",children:s.create.race}),e.jsx(w,{options:I,value:l.race_id,onChange:M,mode:"races",placeholder:s.create.select_race}),n.race_id&&e.jsx("p",{className:"error-msg",children:n.race_id}),S.length>0&&e.jsxs("div",{className:"form-group",children:[e.jsx("p",{className:"form-label",children:e.jsx("strong",{children:s.create.languages})}),e.jsx("ul",{className:"list-languages",children:S.map(a=>e.jsx("li",{children:a.label},a.value))})]})]}),e.jsx("div",{className:"sword-container",children:e.jsx("img",{className:"sword",src:"/images/web/form/sword.png",alt:"Espada decorativa"})}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"subrace",className:"form-label",children:s.create.subrace}),e.jsx(w,{options:y,value:l.subrace_id,onChange:P,disabled:y.length===0,placeholder:y.length===0?f?s.create.no_subrace:s.create.select_race:s.create.select_subrace,mode:"subraces"}),n.subrace_id&&e.jsx("p",{className:"error-msg",children:n.subrace_id})]}),e.jsx("div",{className:"sword-container",children:e.jsx("img",{className:"sword",src:"/images/web/form/sword.png",alt:"Espada decorativa"})}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"class",className:"form-label",children:s.create.class}),e.jsx(w,{options:A,value:l.class_id,onChange:G,placeholder:s.create.select_class,mode:"classes"}),n.class_id&&e.jsx("p",{className:"error-msg",children:n.class_id})]}),e.jsx("div",{className:"sword-container",children:e.jsx("img",{className:"sword",src:"/images/web/form/sword.png",alt:"Espada decorativa"})}),e.jsxs("div",{className:"form-group",children:[e.jsx("p",{className:"form-label section-title",children:s.create.skills}),D.length===0?e.jsx("p",{className:"empty-msg",children:v?s.create.no_skills:s.create.select_skills}):e.jsxs("div",{children:[e.jsxs("p",{className:"selector-msg",children:[s.create.selector," 4 - [",l.skills.length,"]"]}),e.jsx(O,{options:D,selected:l.skills,onChange:a=>r("skills",a)})]}),n.skills&&e.jsx("p",{className:"error-msg",children:n.skills})]}),e.jsx("div",{className:"sword-container",children:e.jsx("img",{className:"sword",src:"/images/web/form/sword.png",alt:"Espada decorativa"})}),e.jsxs("div",{className:"form-group",children:[e.jsx("p",{className:"form-label section-title",children:s.create.traits}),R.length===0?e.jsx("p",{className:"empty-msg",children:f||v?s.create.no_traits:s.create.select_traits}):e.jsxs("div",{children:[e.jsxs("p",{className:"selector-msg",children:[s.create.selector," 5 - [",l.traits.length,"]"]}),e.jsx(O,{options:R,selected:l.traits,onChange:a=>r("traits",a),max:5})]}),n.traits&&e.jsx("p",{className:"error-msg",children:n.traits})]}),e.jsx("div",{className:"sword-container",children:e.jsx("img",{className:"sword",src:"/images/web/form/sword.png",alt:"Espada decorativa"})}),e.jsxs("div",{className:"stats-grid",children:[e.jsx("div",{className:"form-group",children:e.jsx(j,{label:s.create.str,value:l.str,setValue:a=>r("str",a)})}),e.jsx("div",{className:"form-group",children:e.jsx(j,{label:s.create.dex,value:l.dex,setValue:a=>r("dex",a)})}),e.jsx("div",{className:"form-group",children:e.jsx(j,{label:s.create.con,value:l.con,setValue:a=>r("con",a)})}),e.jsx("div",{className:"form-group",children:e.jsx(j,{label:s.create.int,value:l.int,setValue:a=>r("int",a)})}),e.jsx("div",{className:"form-group",children:e.jsx(j,{label:s.create.wis,value:l.wis,setValue:a=>r("wis",a)})}),e.jsx("div",{className:"form-group",children:e.jsx(j,{label:s.create.cha,value:l.cha,setValue:a=>r("cha",a)})})]}),e.jsx("div",{className:"sword-container",children:e.jsx("img",{className:"sword",src:"/images/web/form/sword.png",alt:"Espada decorativa"})}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:s.create.align}),e.jsx("div",{className:"alignment-grid",children:B.map(a=>e.jsx("button",{type:"button",className:`alignment-item ${l.alignment===a.value?"selected":""}`,style:{backgroundColor:l.alignment===a.value?a.color:"#000000ff",color:l.alignment===a.value?"#000000ff":"#ffffffff"},onClick:()=>r("alignment",a.value),children:a.label},a.value))}),n.alignment&&e.jsx("p",{className:"error-msg",children:n.alignment})]}),e.jsx("div",{className:"sword-container",children:e.jsx("img",{className:"sword",src:"/images/web/form/sword.png",alt:"Espada decorativa"})}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"background",className:"form-label",children:s.create.background}),e.jsx(w,{options:T,value:l.background_id,onChange:a=>r("background_id",Number(a)),placeholder:s.create.background,mode:"backgrounds"}),n.background_id&&e.jsx("p",{className:"error-msg",children:n.background_id})]}),e.jsx("div",{className:"sword-container",children:e.jsx("img",{className:"sword",src:"/images/web/form/sword.png",alt:"Espada decorativa"})}),e.jsx(q,{disabled:F,type:"submit",className:"submit-btn",children:F?s.create.saving:o==="edit"?s.create.update??s.create.save:s.create.save})]})})}export{W as F};
